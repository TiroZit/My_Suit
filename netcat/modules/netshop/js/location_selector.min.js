(function(e){function j(a,b,c){if(a)c();else{var d;if(e.define)d=define.amd,define.amd=null;var a=document.createElement("script"),k;a.setAttribute("src",b);a.onreadystatechange=a.onload=function(){k||c();k=!0;if(e.define)define.amd=d};document.getElementsByTagName("head")[0].appendChild(a)}}function l(a,b){var c=d(this.element);h&&h.abort();h=d.ajax({url:NETCAT_PATH+"modules/netshop/actions/location.php",method:"post",dataType:"json",data:{location:a.term},success:b}).always(function(a,b){c.data(m,
"success"===b?a||[]:[]);c.removeClass("tpl-state-loading")});c.addClass("tpl-state-loading");return h}function f(a,b){a.setCustomValidity&&a.setCustomValidity(b?"":n("NetshopLocationIsInvalid","\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u043d\u0430\u0441\u0435\u043b\u0451\u043d\u043d\u044b\u0439 \u043f\u0443\u043d\u043a\u0442"))}function p(a){var b=a.val();b.length?l({term:b},function(c){c=!(!c||!c[0]||!c[0].is_exact_match);a.data(g,c);f(a[0],c)}):(a.data(g,!1),f(a,!0))}function q(a,
b){var c=b.item,e=c.name,c=c.is_suffix_allowed&&-1===e.indexOf(",");o(this,e,c);d(this).data(i,!0);return!1}function o(a,b,c){var e=b+(c?", "+n("NetshopLocationSuffixPlaceholder","\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0433\u043e\u0440\u043e\u0434"):"");d(a).val(e).trigger("change",{from_set_location:!0}).data(g,!0);f(a,!0);c&&a.setSelectionRange(b.length+2,e.length)}function r(a,b){if(!b||!b.from_set_location){var c=d(this);c.data(i)?c.data(i,!1):c.data(g,!1)}}function s(){var a=d(this);a.data(g)||
(a.val().length?(a=a.data(m)||[])&&a[0]&&a[0].name?o(this,a[0].name):f(this,!1):f(this,!0))}function t(){d.fn.ncLocationAutocomplete||d.widget("custom.ncLocationAutocomplete",d.ui.autocomplete,{options:{source:l,select:q,focus:function(a,b){d(a.currentTarget).find("li").each(function(){var a=d(this);a.toggleClass("nc--focus",a.data("value")===b.item.name)})}},_renderMenu:function(a,b){a.addClass("nc-autocomplete-dropdown nc-netshop-location-autocomplete-dropdown");var c=this;d.each(b,function(b,d){c._renderItemData(a,
d)})},_renderItem:function(a,b){return d("<li>").addClass("nc-autocomplete-dropdown-item nc-netshop-location-autocomplete-dropdown-item").attr("data-value",b.name).append(b.name).appendTo(a)},_resizeMenu:function(){this.menu.element.outerWidth(this.element.outerWidth())}})}function n(a,b){var c;e.ncLang&&(c=ncLang[a]);return c||b}var d=e.jQuery,g="ncLocationConfirmed",i="ncLocationSelected",m="ncLocationLastResult",h;e.nc_netshop_init_location_input=function(a){j(e.jQuery,"https://code.jquery.com/jquery-1.12.4.min.js",
function(){d=e.jQuery;d("#nc_netshop_location_selector_styles").length||d("head").prepend('<link rel="stylesheet" href="'+NETCAT_PATH+'modules/netshop/js/location_selector.css" id="nc_netshop_location_selector_styles">');j(d.ui&&d.ui.autocomplete,NETCAT_PATH+"modules/search/suggest/jquery-ui.custom.min.js",function(){t();var b=d(a);b.ncLocationAutocomplete({minLength:2});p(b);b.on("blur",s).on("change",r)})})}})(window);
