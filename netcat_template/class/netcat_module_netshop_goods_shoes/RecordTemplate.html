<?/* Служебная часть */for ($f_RowNum = 0; $f_RowNum < $rowCount; $f_RowNum++) {    if($fetch_row[$f_RowNum] instanceof Iterator) {        extract($fetch_row[$f_RowNum]->to_array(), EXTR_PREFIX_ALL, "f");    } else {        extract($fetch_row[$f_RowNum], EXTR_PREFIX_ALL, "f");    }    foreach($iteration_RecordTemplate[$f_RowNum] as $value) {        extract($value);    }    eval($cc_env["convert2txt"]);    ob_start();/* Конец служебной части */?>
<?php
$item = new nc_netshop_item($res[$f_RowNum]);
$item_parent_id = $item['Parent_Message_ID'] ?: $item['Message_ID'];
$item_list_key = $item['Class_ID'] . ':' . $item_parent_id;
$item_in_stock = (!$nc_core->get_settings('IgnoreStockUnitsValue', 'netshop') ? ($item['StockUnits'] > 0) : true);
$in_cart = $netshop_cart_items[$item_list_key]['Qty'] > 0;
$is_in_compare_list = !$template_partial_loading && $netshop->goodslist_compare->check($item_parent_id, $item['Class_ID']);
$is_in_fav_list = !$template_partial_loading && $netshop->goodslist_favorite->check($item_parent_id, $item['Class_ID']);

$compare_url = !$is_in_compare_list ?
    $netshop->goodslist_compare->get_add_action_url($item['Message_ID'], $item['Class_ID']) :
    $netshop->goodslist_compare->get_remove_action_url($item['Message_ID'], $item['Class_ID']);

$favorite_url = !$is_in_fav_list ?
    $netshop->goodslist_favorite->get_add_action_url($item['Message_ID'], $item['Class_ID']) :
    $netshop->goodslist_favorite->get_remove_action_url($item['Message_ID'], $item['Class_ID']);


// запрет кэширования страницы сервером, если цена или скидки зависят от пользователя
if ($template_partial_loading && $item->price_depends_on_user_data()) {
    header('X-Accel-Expires: 0');
}
?>

<div class="nc-infoblock-object goods-item type-<?= $_COOKIE['catalogue-type'] ?: "list"; ?><?= $inside_admin ? ' inside-admin' : '' ?>"
     data-component-id="<?= $item['Class_ID']; ?>" data-message-id="<?= $item_parent_id; ?>"<?= $goods_item_styles; ?>>
    <?= $f_AdminButtons; ?>
    <a href="<?= $item['URL']; ?>" class="item-image">
        <?php if($item['Image']) { ?>
            <div class="image">
                <?= $item['Image']->as_img(array('alt' => $item['FullName'])); ?>
            </div>
        <?php } ?>
    </a>
    <a href="<?= $item['URL']; ?>" class="item-info">
        <div>
            <div class="tpl-text-header4"><?= $item['Name']; ?></div>
            <div class="tpl-text-default-paragraph"><?= $item['Type']; ?></div>
        </div>
        <div class="item-price tpl-text-header6">
            <?php if ($item['ItemPriceRange']) { ?>
                <span><?= $item['ItemPriceRange']; ?></span>
            <?php } else { ?>
                <span><?= $item['ItemPriceF']; ?></span>
            <?php } ?>
        </div>
    </a>

    <form action="<?= $netshop->get_add_to_cart_url() ?>" method="post" class="item-actions">
        <input type="hidden" name="redirect_url" value="<?= $_SERVER["REQUEST_URI"] ?>"/>
        <input type="hidden" name="cart_mode" value="add"/>
        <input type="hidden" name="items[]" value="<?= $item['Class_ID'] . ':' . $item_parent_id; ?>"/>
        <input type="hidden" name="item_id" value="<?= $item_parent_id; ?>"/>
        <input type="hidden" name="class_id" value="<?= $item['Class_ID']; ?>"/>

        <div class="actions-link">
            <!-- quick buy button -->
            <?php if ($item_in_stock && $item['Checked']): ?>
                <a href="" class="tpl-text-alt-small quickbuy"
                   onclick="nc_netshop_quick_order(this);return false;">
                   <i class="fas fa-shopping-basket"></i> купить сейчас
                </a>
            <?php endif; ?>
            <!-- compare button -->
            <a href="<?= $compare_url; ?>"
               class="tpl-text-alt-small <?= $is_in_compare_list ? 'active' : ''; ?> compare"
               onclick="nc_netshop_goodslist('compare', '<?= $is_in_compare_list ? "remove" : "add"; ?>', <?= $item_parent_id; ?>, <?= $item['Class_ID']; ?>, this ); return false;">
                <i class="far fa-copy"></i>
                <?= $is_in_compare_list ? $btn_in_compare_text : $btn_not_in_compare_text; ?>
            </a>
        </div>

        <div class="actions-cart">
            <?php if ($item_in_stock && $item['Checked']) { ?>
                <div class="quantity">
                    <button type="button" class="quantity-button quantity-button--less"></button>
                    <input type="number" class="quantity-input" name="qty" value="1" min="1" step="1">
                    <button type="button" class="quantity-button quantity-button--more"></button>
                </div>
            <?php } ?>
            <div class="cart-button">
                <?php if ($item['Checked']): ?>
                    <button type="submit" <?= !$item_in_stock ? "disabled" : ""; ?>
                            class="tpl-button-primary addBasket" onclick="nc_netshop_cart(this); return false;">
                        <?= $in_cart ? "В корзине" : ($item_in_stock ? "В корзину" : "Нет в наличии"); ?>
                    </button>
                <?php else: ?>
                    <a href="<?= $fullLink ?>" class="tpl-button-primary addBasket">Выбрать</a>
                <?php endif; ?>

                <a href="<?= $favorite_url; ?>" class="addFavorite"
                   title="<?= $is_in_fav_list ? "Товар в избранном" : "Добавить в избранное"; ?>"
                   onclick="nc_netshop_goodslist('favorite', '<?= $is_in_fav_list ? "remove" : "add"; ?>', <?= $item_parent_id; ?>, <?= $item['Class_ID']; ?>, this ); return false;">
                    <i class="<?= $is_in_fav_list ? "fas" : "far"; ?> fa-star"></i>
                </a>
            </div>
        </div>
    </form>
    <?php if ($inside_admin && $variant_fields): ?>
        <?= nc_netshop_item_variant_admin_table($item); ?>
    <?php endif; ?>
</div>
<?/* Служебная часть */    echo nc_finishing_RecordTemplate(ob_get_clean(), $inside_admin, $classID, $f_RowID, $parent_message, $cc, $cc_env["Class_Name"], $no_cache_marks);}/* Конец служебной части */?>