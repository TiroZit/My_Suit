(function(m){function y(a,c){if(n.test(a)&&g.test(c))a="right";else if(g.test(a)&&n.test(c))a="left";else if(p.test(a)&&h.test(c))a="bottom";else if(h.test(a)&&p.test(c))a="top";else return"";return"tpl-dropdown-to-"+a}var g=/left/,n=/right/,h=/top/,p=/bottom/,q=m("body"),u;window.nc_visibility_dropdown=function(a){function c(a){d.css({visibility:"hidden",top:0,left:0,zIndex:9E3,overflow:"visible"}).show().position({my:k,at:g,of:n,collision:b.on_collision}).css("visibility","").addClass("tpl-dropdown-visible");
e.removeClass("tpl-dropdown-trigger-closed").addClass("tpl-dropdown-trigger-opened");l=!0;a&&"click"===a.type?(a.preventDefault(),v=!0):v=!1;q.on("click",w);q.find(".tpl-dropdown-visible").each(function(){var a=m(this),x=a.data("hide.nc_visibility_dropdown");x&&!d.closest(a).length&&x()})}function r(){d.hide().removeClass("tpl-dropdown-visible");e.removeClass("tpl-dropdown-trigger-opened").addClass("tpl-dropdown-trigger-closed");t=l=!1;q.off("click",w)}function w(a){var b=m(a.target);l&&"click"===
a.type&&!b.closest(e).length&&(r(),v&&a.preventDefault())}var d=m(a.block_element),e=d.parent().closest(".tpl-dropdown-trigger, .tpl-block-list, .tpl-container"),b=a.settings;a=a.settings.position_block_level||!1;var f=d.parents(".tpl-dropdown-trigger, .tpl-block-list"),n=a?f.eq(Math.min(a,f.length)-1):e,g=b.trigger_anchor,k=b.dropdown_anchor;a=b.gap_vertical;f=b.gap_horizontal;var p="hover"===b.show_trigger,h=y(g,k),l=!1,v=!1,t;e.addClass("tpl-dropdown-trigger tpl-dropdown-trigger-closed "+h);d.addClass("tpl-dropdown").hide().data("hide.nc_visibility_dropdown",
r);parseInt(f)&&(k=k.replace(" ",(0<=f?"+":"")+f+b.gap_horizontal_unit+" "));parseInt(a)&&(k+=(0<=a?"+":"")+a+b.gap_vertical_unit);e.on("click.nc_visibility_dropdown",function(a){l?w(a):c(a)}).on("mouseenter.nc_visibility_dropdown",function(a){if(p||q.find(".tpl-dropdown-visible").length)clearTimeout(u),clearTimeout(t),u=setTimeout(function(){c(a)},301)}).on("mouseleave.nc_visibility_dropdown",function(){l&&(t=setTimeout(function(){r()},300))});this.destroy=function(){clearTimeout(u);clearTimeout(t);
r();e.off(".nc_visibility_dropdown").removeClass(h+" tpl-dropdown-trigger-opened tpl-dropdown-trigger-closed");d.css({top:"",left:"",zIndex:"",overflow:"",display:""}).removeClass("tpl-dropdown").removeData("hide.nc_visibility_dropdown")}}})(jQuery);
